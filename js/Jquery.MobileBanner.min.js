(function (window) { var w = window.screen.availWidth; var l = $("#smh_banner ul li").length; var c = 0; var timer = null; var parm = {}; $(document).ready(function () { var countwidth = l * w; $("#smh_banner ul").css("width", countwidth + "px"); var html = ""; for (var i = 1; i <= l; i++) { html += '<span class="' + (i == 1 ? "active" : "23") + '"></span>' } var dw = 15 * l - 5; var dw1 = (w - dw) / 2; $(".pagination").html(html) }); function addanimation(i) { var animation = $("#smh_banner ul li:eq(" + i + ")").css("animation"); if (animation != "") { $("#smh_banner ul li:eq(" + i + ")").css("animation", "scrollBad " + parm.animation + " linear infinite").siblings().css("animation", "") } } function star(number) { if (number != null) { var leftw = number * w + "px"; $("#smh_banner ul").animate({ left: "-" + leftw }); var d = $("#smh_banner ul li:eq(" + number + ")").css("animation"); addanimation(number); $(".pagination span:eq(" + number + ")").addClass("active").siblings().removeClass("active") } else { if (c < l - 1) { c++ } else { c = 0 } addanimation(c); var left = $("#smh_banner ul").css("left").replace("-", "").replace("px", ""); var leftwidth = (l - 1) * w; if (left == leftwidth) { $("#smh_banner ul").animate({ left: "0px" }) } else { $("#smh_banner ul").animate({ left: "-=" + w + "px" }) } $(".pagination span:eq(" + c + ")").addClass("active").siblings().removeClass("active") } } var startX, startY, moveEndX, moveEndY, X, Y; $("#smh_banner").on("touchstart", function (e) { e.preventDefault(); startX = e.originalEvent.changedTouches[0].pageX, startY = e.originalEvent.changedTouches[0].pageY }); $("#smh_banner").on("touchmove", function (e) { moveEndX = e.originalEvent.changedTouches[0].pageX, moveEndY = e.originalEvent.changedTouches[0].pageY, X = moveEndX - startX, Y = moveEndY - startY }); function resettimer() { window.clearInterval(timer); timer = setInterval(star, obj.time) } $("#smh_banner").on("touchend", function (e) { if (Math.abs(X) > Math.abs(Y) && X > 0) { var right = c - 1; if (c == 0) { c = l - 1 } else { c = right } star(c); resettimer() } else { if (Math.abs(X) > Math.abs(Y) && X < 0) { var left = c + 1; if (c == (l - 1)) { left = 0 } c = left; star(c); resettimer() } } }); function MobileBanner(obj) { this.init = function () { parm = obj; timer = setInterval(star, obj.time); $("#smh_banner ul li:eq(0)").css("animation", "scrollBad " + parm.animation + " linear infinite") } } function $smh(obj) { return new MobileBanner(obj) } window.MobileBanner = $smh }(window));